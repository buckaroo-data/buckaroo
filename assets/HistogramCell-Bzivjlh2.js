import{j as e}from"./jsx-runtime-DiklIkkE.js";import{r as _,R as H}from"./index-DRjF_FHU.js";import{r as E}from"./index-DIvcuAjW.js";import{a as K,X as N,Y as B,f as q,B as r,b as M,T as $}from"./ChartCell-BfPIzAg-.js";import{i as D}from"./isArray-Dxzbedgu.js";const n=typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(prefers-color-scheme: dark)"):null;function O(t){return n==null||n.addEventListener("change",t),()=>n==null?void 0:n.removeEventListener("change",t)}function X(){return n!=null&&n.matches?"dark":"light"}function G(){return"dark"}function L(){return _.useSyncExternalStore(O,X,G)}var R=K({chartName:"BarChart",GraphicalChild:r,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:N},{axisType:"yAxis",AxisComp:B}],formatAxisMap:q});const Y=(t,a,s)=>s.payload.name==="longtail"?[t,a]:[t,s.payload.name],F=({active:t,payload:a,screenCoords:s})=>{if(t&&a&&a.length&&s){const l=a[0].payload.name;return E.createPortal(e.jsx("div",{style:{backgroundColor:"#eee",padding:"5px 10px 5px 10px",color:"#111",position:"absolute",top:s.y+10,left:s.x+10},children:e.jsx("p",{className:"label",children:`${l} : ${a[0].value}%`})}),document.body)}return null},V=t=>{const a=L();if(t===void 0)return e.jsx("span",{});const s=t.value;return s===void 0||!D(s)?e.jsx("span",{}):h({histogramArr:s,context:t.context,className:t.colDef.cellClass||"",colorScheme:a})},h=({histogramArr:t,context:a,className:s,colorScheme:l="dark"})=>{const x=(o,c)=>{console.log("dumbClickHandler",o,a)},i=M(l),p=l==="light",u=p?"#888":"#000",m=p?"#999":"gray",f=p?"#666":"#000",d=o=>{const c=`${o}-${crypto.randomUUID()}`;return[c,`url(#${c})`]},[g,y]=d("star"),[k,A]=d("stripe"),[j,v]=d("circle"),[C,w]=d("checkers"),[T,I]=d("leafs"),[S,U]=H.useState(null),b=`histogram-component ${s}`;return e.jsx("div",{className:b,children:e.jsxs(R,{width:100,height:24,barGap:1,data:t,onClick:x,onMouseMove:(o,c)=>{U({x:c.clientX,y:c.clientY})},children:[e.jsxs("defs",{children:[e.jsx("pattern",{id:g,width:"10",height:"10",patternUnits:"userSpaceOnUse",children:e.jsx("polygon",{stroke:i.cat_pop,points:"0,0 2,5 0,10 5,8 10,10 8,5 10,0 5,2"})}),e.jsx("pattern",{id:k,width:"4",height:"4",patternUnits:"userSpaceOnUse",patternTransform:"rotate(45)",children:e.jsx("rect",{width:"2",height:"4",fill:i.NA})}),e.jsx("pattern",{id:j,width:"4",height:"4",patternUnits:"userSpaceOnUse",children:e.jsx("circle",{"data-color":"outline",stroke:i.cat_pop,cx:".5",cy:".5",r:"1.5"})}),e.jsxs("pattern",{id:C,x:"0",y:"0",width:"4",height:"4",patternUnits:"userSpaceOnUse",children:[e.jsx("rect",{stroke:i.unique,x:"0",width:"2",height:"2",y:"0"}),e.jsx("rect",{x:"2",width:"2",height:"2",y:"2"})]}),e.jsx("pattern",{id:T,x:"0",y:"0",width:"6",height:"6",patternUnits:"userSpaceOnUse",patternTransform:"translate(1, 1) rotate(0) skewX(0)",children:e.jsx("svg",{width:"5",height:"5",viewBox:"0 0 100 100",children:e.jsx("g",{fill:i.longtail,opacity:"1",children:e.jsx("path",{d:"M99.9557 99.9557C45.4895 98.3748 1.6248 54.5101 0.0439453 0.0439453C54.5101 1.6248 98.3748 45.4895 99.9557 99.9557Z"})})})})]}),e.jsx(r,{dataKey:"population",stroke:u,fill:m,stackId:"stack",isAnimationActive:!1}),e.jsx(r,{dataKey:"tail",stroke:u,fill:m,stackId:"stack",isAnimationActive:!1}),e.jsx(r,{dataKey:"true",stroke:"#00f",fill:"#00f",stackId:"stack",isAnimationActive:!1}),e.jsx(r,{dataKey:"false",stroke:f,fill:"#fff",stackId:"stack",isAnimationActive:!1}),e.jsx(r,{dataKey:"cat_pop",stroke:i.cat_pop,fill:v,stackId:"stack",isAnimationActive:!1}),e.jsx(r,{dataKey:"unique",stroke:i.unique,fill:w,stackId:"stack",isAnimationActive:!1}),e.jsx(r,{dataKey:"longtail",stroke:i.longtail,fill:I,stackId:"stack",isAnimationActive:!1}),e.jsx(r,{dataKey:"user1",stroke:i.longtail,fill:y,stackId:"stack",isAnimationActive:!1}),e.jsx(r,{dataKey:"NA",fill:A,stackId:"stack",isAnimationActive:!1}),e.jsx($,{formatter:Y,allowEscapeViewBox:{x:!0,y:!0},wrapperStyle:{zIndex:99999999,color:"#111"},content:o=>e.jsx(F,{...o,screenCoords:S})})]})})};V.__docgenInfo={description:"",methods:[],displayName:"HistogramCell",props:{api:{required:!0,tsType:{name:"GridApi"},description:""},colDef:{required:!0,tsType:{name:"ColDef"},description:""},column:{required:!0,tsType:{name:"Column"},description:""},context:{required:!0,tsType:{name:"Context"},description:""},value:{required:!0,tsType:{name:"any"},description:""}}};h.__docgenInfo={description:"",methods:[],displayName:"TypedHistogramCell",props:{histogramArr:{required:!0,tsType:{name:"Array",elements:[{name:"HistogramBar"}],raw:"HistogramBar[]"},description:""},context:{required:!0,tsType:{name:"any"},description:""},className:{required:!1,tsType:{name:"string"},description:""},colorScheme:{required:!1,tsType:{name:"union",raw:"'light' | 'dark'",elements:[{name:"literal",value:"'light'"},{name:"literal",value:"'dark'"}]},description:"",defaultValue:{value:"'dark'",computed:!1}}}};export{V as H,h as T,L as u};
