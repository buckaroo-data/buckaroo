import{a as Z,A as Me,M as Q,C as Ne,I as ke,t as X,b as Oe,c as Pe}from"./index.esm-BKJF1BwD.js";import{j as w}from"./jsx-runtime-DiklIkkE.js";import{r as m}from"./index-DRjF_FHU.js";import{u as ee,H as Le}from"./HistogramCell-Bzivjlh2.js";import{g as Ee}from"./ChartCell-BfPIzAg-.js";import{x as W,o as Ae,y as Ge,z as ne,A as te,f as re,b as oe,k as M,B as je,v as Be,j as ae,l as ce,C as Ve,D as $,E as P,F as se,e as He,w as E}from"./_baseEach-B-y44WsN.js";import{b as qe,o as We,a as ie,i as le,l as $e,m as x}from"./isString-CNnovG4X.js";import{i as G}from"./isArray-Dxzbedgu.js";function Ue(){}function de(e,n,t,r){for(var o=e.length,a=t+-1;++a<o;)if(n(e[a],a,e))return a;return-1}function ze(e){return e!==e}function Je(e,n,t){for(var r=t-1,o=e.length;++r<o;)if(e[r]===n)return r;return-1}function j(e,n,t){return n===n?Je(e,n,t):de(e,ze,t)}function fe(e,n){var t=e==null?0:e.length;return!!t&&j(e,n,0)>-1}var U=W?W.isConcatSpreadable:void 0;function Ye(e){return G(e)||Ae(e)||!!(U&&e&&e[U])}function Ke(e,n,t,r,o){var a=-1,c=e.length;for(t||(t=Ye),o||(o=[]);++a<c;){var s=e[a];t(s)&&Ge(o,s)}return o}var Ze=1,Qe=4;function Xe(e){return qe(e,Ze|Qe)}var en=200;function nn(e,n,t,r){var o=-1,a=fe,c=!0,s=e.length,i=[],f=n.length;if(!s)return i;n.length>=en&&(a=te,c=!1,n=new ne(n));e:for(;++o<s;){var d=e[o],l=d;if(d=d!==0?d:0,c&&l===l){for(var g=f;g--;)if(n[g]===l)continue e;i.push(d)}else a(n,l,r)||i.push(d)}return i}function tn(e){return function(n,t,r){var o=Object(n);if(!re(n)){var a=oe(t);n=M(n),t=function(s){return a(o[s],s,o)}}var c=e(n,t,r);return c>-1?o[a?n[c]:c]:void 0}}var rn=Math.max;function on(e,n,t){var r=e==null?0:e.length;if(!r)return-1;var o=t==null?0:Z(t);return o<0&&(o=rn(r+o,0)),de(e,oe(n),o)}var N=tn(on),an=Object.prototype,cn=an.hasOwnProperty;function sn(e,n){return e!=null&&cn.call(e,n)}function B(e,n){return e!=null&&je(e,n,sn)}function ln(e,n){return Be(n,function(t){return e[t]})}function dn(e){return e==null?[]:ln(e,M(e))}var fn=Math.max;function k(e,n,t,r){e=re(e)?e:dn(e),t=t?Z(t):0;var o=e.length;return t<0&&(t=fn(o+t,0)),We(e)?t<=o&&e.indexOf(n,t)>-1:!!o&&j(e,n,t)>-1}function un(e,n,t){var r=e==null?0:e.length;if(!r)return-1;var o=0;return j(e,n,o)}var mn="[object Boolean]";function gn(e){return e===!0||e===!1||ae(e)&&ce(e)==mn}var bn="[object Date]";function hn(e){return ae(e)&&ce(e)==bn}var z=$&&$.isDate,pn=z?Ve(z):hn,yn=1/0,wn=P&&1/se(new P([,-0]))[1]==yn?function(e){return new P(e)}:Ue,Cn=200;function Dn(e,n,t){var r=-1,o=fe,a=e.length,c=!0,s=[],i=s;if(a>=Cn){var f=wn(e);if(f)return se(f);c=!1,o=te,i=new ne}else i=s;e:for(;++r<a;){var d=e[r],l=d;if(d=d!==0?d:0,c&&l===l){for(var g=i.length;g--;)if(i[g]===l)continue e;s.push(d)}else o(i,l,t)||(i!==s&&i.push(l),s.push(d))}return s}var Rn=ie(function(e){return Dn(Ke(e,1,le))}),_n=ie(function(e,n){return le(e)?nn(e,n):[]});function Sn(e,n,t){for(var r=-1,o=e.length,a=n.length,c={};++r<o;){var s=r<a?n[r]:void 0;t(c,e[r],s)}return c}function xn(e,n){return Sn(e||[],n||[],$e)}const ue=["chart","histogram","linkify","Base64PNGImageDisplayer","SVGDisplayer"],yt={dfviewer_config:{pinned_rows:[],column_config:[],left_col_configs:[]},data:[]},L=e=>t=>w.jsx("span",{children:e(t)}),me=e=>w.jsx("a",{href:e.value,children:e.value}),ge=e=>{const n="data:image/png;base64,"+e.value;return w.jsx("img",{src:n})},be=e=>{const n={__html:e.value};return w.jsx("div",{dangerouslySetInnerHTML:n})};me.__docgenInfo={description:"",methods:[],displayName:"LinkCellRenderer"};ge.__docgenInfo={description:"",methods:[],displayName:"Base64PNGDisplayer"};be.__docgenInfo={description:"",methods:[],displayName:"SVGDisplayer"};const Fn=["#e65036","#e65138","#e75339","#e7553a","#e8563c","#e8583d","#e9593f","#e95b40","#e95c41","#ea5e43","#ea5f44","#eb6046","#eb6247","#ec6349","#ec654a","#ec664b","#ed684d","#ed694e","#ee6a50","#ee6c51","#ee6d52","#ef6f54","#ef7055","#ef7157","#f07358","#f0745a","#f1765b","#f1775d","#f1785e","#f27a5f","#f27b61","#f27c62","#f37e64","#f37f65","#f38067","#f48268","#f4836a","#f4846b","#f5866c","#f5876e","#f5886f","#f58a71","#f68b72","#f68c74","#f68d75","#f78f77","#f79078","#f7917a","#f7937b","#f8947d","#f8957e","#f89780","#f89881","#f99983","#f99a84","#f99c86","#f99d87","#f99e89","#faa08a","#faa18c","#faa28d","#faa38f","#faa590","#fba692","#fba793","#fba995","#fbaa96","#fbab98","#fbac99","#fcae9b","#fcaf9c","#fcb09e","#fcb19f","#fcb3a1","#fcb4a2","#fcb5a4","#fcb7a5","#fdb8a7","#fdb9a8","#fdbaaa","#fdbcac","#fdbdad","#fdbeaf","#fdbfb0","#fdc1b2","#fdc2b3","#fdc3b5","#fdc4b6","#fdc6b8","#fdc7ba","#fdc8bb","#fdcabd","#fdcbbe","#fdccc0","#fdcdc1","#fdcfc3","#fdd0c5","#fdd1c6","#fdd2c8","#fdd4c9","#fdd5cb","#fdd6cc","#fdd7ce","#fdd9d0","#fddad1","#fddbd3","#fddcd4","#fdded6","#fcdfd8","#fce0d9","#fce1db","#fce3dc","#fce4de","#fce5e0","#fce7e1","#fce8e3","#fbe9e5","#fbeae6","#fbece8","#fbede9","#fbeeeb","#faefed","#faf1ee","#faf2f0","#faf3f2","#f9f4f3","#f9f5f5","#f8f6f6","#f7f6f7","#f6f6f8","#f5f5f9","#f4f4f9","#f3f3f9","#f1f2f9","#f0f1f9","#eff0f9","#eeeffa","#edeefa","#ecedfa","#eaecfa","#e9ebfa","#e8eafa","#e7e9fa","#e6e8fa","#e5e7fa","#e3e6fa","#e2e5fa","#e1e4fa","#e0e3fa","#dfe2fb","#dde1fb","#dce0fb","#dbdffb","#dadefb","#d9ddfb","#d7dcfb","#d6dbfb","#d5dafb","#d4d9fb","#d3d8fb","#d1d7fb","#d0d6fb","#cfd5fb","#ced4fb","#cdd3fc","#cbd2fc","#cad1fc","#c9d0fc","#c8cffc","#c6cefc","#c5cdfc","#c4ccfc","#c3cbfc","#c1cafc","#c0c9fc","#bfc8fc","#bdc7fc","#bcc7fc","#bbc6fc","#bac5fc","#b8c4fc","#b7c3fc","#b6c2fc","#b4c1fd","#b3c0fd","#b2bffd","#b0befd","#afbdfd","#aebcfd","#acbbfd","#abbafd","#aab9fd","#a8b8fd","#a7b7fd","#a5b6fd","#a4b5fd","#a3b4fd","#a1b3fd","#a0b2fd","#9eb2fd","#9db1fd","#9bb0fd","#9aaffd","#99aefd","#97adfd","#96acfd","#94abfd","#93aafd","#91a9fd","#90a8fd","#8ea7fd","#8ca6fd","#8ba5fe","#89a4fe","#88a4fe","#86a3fe","#84a2fe","#83a1fe","#81a0fe","#809ffe","#7e9efe","#7c9dfe","#7a9cfe","#799bfe","#779afe","#759afe","#7399fe","#7198fe","#7097fe","#6e96fe","#6c95fe","#6a94fe","#6893fe","#6692fe","#6491fe","#6291fe","#5f90fe","#5d8ffe","#5b8efe","#598dfe","#568cfe","#548bfe","#518afe","#4f8afe","#4c89fe","#4988fe","#4787fe","#4486fe","#4085fe","#3d84fe","#3a83fe","#3683fe","#3282fe","#2e81fe","#2980fe","#247ffe"],vn=["#0488fc","#1089fb","#1789fb","#1d89fa","#228afa","#268af9","#2a8af9","#2e8af8","#318bf7","#348bf7","#378bf6","#3a8cf6","#3c8cf5","#3f8cf5","#418df4","#438df4","#458df3","#488df2","#4a8ef2","#4c8ef1","#4d8ef1","#4f8ff0","#518ff0","#538fef","#5490ee","#5690ee","#5890ed","#5991ed","#5b91ec","#5c91ec","#5e92eb","#5f92ea","#6192ea","#6292e9","#6393e9","#6593e8","#6693e8","#6794e7","#6994e6","#6a94e6","#6b95e5","#6c95e5","#6e95e4","#6f96e4","#7096e3","#7196e3","#7297e2","#7397e1","#7497e1","#7698e0","#7798e0","#7898df","#7999df","#7a99de","#7b99dd","#7c9add","#7d9adc","#7e9adc","#7f9bdb","#809bdb","#819bda","#829cd9","#839cd9","#849cd8","#849dd8","#859dd7","#869dd7","#879ed6","#889ed5","#899ed5","#8a9fd4","#8b9fd4","#8c9fd3","#8ca0d3","#8da0d2","#8ea0d1","#8fa1d1","#90a1d0","#91a1d0","#91a2cf","#92a2ce","#93a2ce","#94a3cd","#95a3cd","#95a3cc","#96a4cc","#97a4cb","#98a4ca","#98a5ca","#99a5c9","#9aa5c9","#9ba6c8","#9ba6c8","#9ca6c7","#9da7c6","#9ea7c6","#9ea7c5","#9fa8c5","#a0a8c4","#a0a9c3","#a1a9c3","#a2a9c2","#a2aac2","#a3aac1","#a4aac1","#a4abc0","#a5abbf","#a6abbf","#a6acbe","#a7acbe","#a8acbd","#a8adbc","#a9adbc","#aaadbb","#aaaebb","#abaeba","#acafb9","#acafb9","#adafb8","#adb0b8","#aeb0b7","#afb0b7","#afb1b6","#b0b1b5","#b1b1b5","#b1b2b4","#b2b2b4","#b2b2b3","#b3b3b2","#b4b3b2","#b4b3b1","#b5b4b1","#b6b4b0","#b7b4af","#b7b5af","#b8b5ae","#b9b5ad","#bab6ad","#bab6ac","#bbb6ac","#bcb7ab","#bcb7aa","#bdb7aa","#beb8a9","#beb8a8","#bfb8a8","#c0b9a7","#c0b9a7","#c1b9a6","#c2baa5","#c2baa5","#c3baa4","#c4bba3","#c4bba3","#c5bba2","#c6bca2","#c6bca1","#c7bca0","#c8bca0","#c8bd9f","#c9bd9e","#cabd9e","#cabe9d","#cbbe9c","#ccbe9c","#ccbf9b","#cdbf9b","#cdbf9a","#cec099","#cfc099","#cfc098","#d0c197","#d1c197","#d1c196","#d2c295","#d2c295","#d3c294","#d4c393","#d4c393","#d5c392","#d5c491","#d6c491","#d7c490","#d7c58f","#d8c58f","#d8c58e","#d9c68d","#dac68d","#dac68c","#dbc78b","#dbc78b","#dcc78a","#dcc889","#ddc889","#dec888","#dec987","#dfc987","#dfc986","#e0ca85","#e0ca85","#e1ca84","#e2cb83","#e2cb83","#e3cc82","#e3cc81","#e4cc80","#e4cd80","#e5cd7f","#e6cd7e","#e6ce7e","#e7ce7d","#e7ce7c","#e8cf7b","#e8cf7b","#e9cf7a","#e9d079","#ead078","#ead078","#ebd177","#ecd176","#ecd176","#edd275","#edd274","#eed273","#eed373","#efd372","#efd371","#f0d470","#f0d46f","#f1d46f","#f1d56e","#f2d56d","#f2d56c","#f3d66c","#f3d66b","#f4d66a","#f5d769","#f5d768","#f6d868","#f6d867","#f7d866","#f7d965","#f8d964","#f8d963","#f9da63","#f9da62","#fada61","#fadb60","#fbdb5f","#fbdb5e","#fcdc5d","#fcdc5d","#fddc5c","#fddd5b","#fedd5a","#fedd59"],he=e=>e==="BLUE_TO_YELLOW"?vn:e==="DIVERGING_RED_WHITE_BLUE"?Fn:e;function Tn(e,n){const t=n.length;if(t===0)return 0;for(let r=0;r<n.length;r++)if(e<=n[r])return r;return e>n[t-1]?t-1:n.length}function In(e){function n(t){var y;const r=he(e.map_name),o={backgroundColor:"inherit"},a=(y=t.context)==null?void 0:y.histogram_stats,c=e.val_column;if(c===void 0||a===void 0)return console.log("66 couldn't find stats_col"),o;const s=a[c];if(s===void 0||s.histogram_bins===void 0)return console.log("69 couldn't find summary_stats"),o;const i=s.histogram_bins;function f(h){const D=Tn(h,i),R=Math.round(D/i.length*r.length);return r[R]}const d=e.val_column&&t.data?t.data[e.val_column]:t.value,l=f(d);return{backgroundColor:t.node.rowPinned?"inherit":l}}return{cellStyle:n}}function Mn(e){const n=he(e.map_name);function t(r){const o=e.val_column&&r.data?r.data[e.val_column]:r.value;return{backgroundColor:r.node.rowPinned?"inherit":n[o]}}return{cellStyle:t}}function Nn(e){function n(r){if(r.data===void 0)return{backgroundColor:"inherit"};const o=r.data[e.exist_column],a=o&&o!==null,c=r.node.rowPinned;return{backgroundColor:a&&!c?e.conditional_color:"inherit"}}return{cellStyle:n}}function kn(e){function n(t){if(t.data===void 0)return{backgroundColor:"inherit"};const r=t.data[e.val_column],o=t.node.rowPinned;return{backgroundColor:r&&!o?r:"inherit"}}return{cellStyle:n}}function On(e){switch(e.color_rule){case"color_map":return In(e);case"color_categorical":return Mn(e);case"color_from_column":return kn(e);case"color_not_null":return Nn(e)}}Q.registerModules([Ne]);Q.registerModules([ke]);const Pn="#2196F3",Ln={rowSelection:"single",enableCellTextSelection:!0,tooltipShowDelay:0,suppressFieldDotNotation:!0,onRowClicked:e=>{var o;const n=document.getSelection();if(n===null)return;const t=document.createRange(),r=(o=e==null?void 0:e.event)==null?void 0:o.target;r!=null&&(t.selectNodeContents(r),n.removeAllRanges(),n.addRange(t))}},En=(e,n)=>({...Ln,...n||{},onCellClicked:t=>{const r=t.column.getColId();if(!(e===void 0||r===void 0)){const o=t.context.activeCol,a=[r,t.column.colDef.headerName];e(a),t.context.activeCol=a;const c={rowNodes:t.api.getRenderedNodes(),columns:[t.api.getColumn(r),t.api.getColumn(o[0])],force:!0};t.api.refreshCells(c)}}});function pe({data_wrapper:e,df_viewer_config:n,summary_stats_data:t,activeCol:r,setActiveCol:o,outside_df_params:a,error_info:c,max_rows_in_configs:s}){var F,v;const i=m.useMemo(()=>Date.now(),[]),f=5,d=n==null?void 0:n.component_config,l=(F=n==null?void 0:n.extra_grid_config)==null?void 0:F.rowHeight,g=JSON.stringify([f,d,l]),b=m.useMemo(()=>{var S;return rt(s||e.length,n.pinned_rows.length,n==null?void 0:n.component_config,(S=n==null?void 0:n.extra_grid_config)==null?void 0:S.rowHeight)},[g]),y=["",""],D=ee()==="light"?"ag-theme-alpine":"ag-theme-alpine-dark",R=((v=n==null?void 0:n.component_config)==null?void 0:v.className)||D;return w.jsxs("div",{className:`df-viewer  ${b.classMode} ${b.inIframe}`,children:[c?w.jsx("pre",{children:c}):null,w.jsx("div",{style:b.applicableStyle,className:`theme-hanger ${R}`,children:w.jsx(ye,{data_wrapper:e,df_viewer_config:n,summary_stats_data:t||[],activeCol:r||y,setActiveCol:o,outside_df_params:a,renderStartTime:i,hs:b})})]})}function ye({data_wrapper:e,df_viewer_config:n,summary_stats_data:t,activeCol:r,setActiveCol:o,outside_df_params:a,renderStartTime:c,hs:s}){const i=m.useMemo(()=>et(n),[n]),f=m.useMemo(()=>({sortable:!0,type:"rightAligned",cellStyle:u=>{var T;const p=u.column.getColDef().field,_=(T=u.context)==null?void 0:T.activeCol[0];if(!u.node.isRowPinned())return _===p?{background:Pn}:{background:"inherit"}},enableCellChangeFlash:!1,cellRendererSelector:nt(n.pinned_rows,n.column_config)}),[n.pinned_rows,n.column_config]),d=tt(t),l={activeCol:r,histogram_stats:d,pinned_rows_config:n.pinned_rows},g=n.pinned_rows,b=m.useMemo(()=>Qn(t,g||[]),[t,g]),y=m.useCallback(u=>{var _,T;const C=JSON.stringify((_=u.context)==null?void 0:_.outside_df_params)||"";return`${String((T=u==null?void 0:u.data)==null?void 0:T.index)}-${C}`},[a]),h=ee(),D=m.useMemo(()=>lt(h).withParams({headerRowBorder:!0,headerColumnBorder:!0,headerColumnResizeHandleWidth:0,...h==="dark"?{backgroundColor:"#121212",oddRowBackgroundColor:"#3f3f3f"}:{backgroundColor:"#ffffff",oddRowBackgroundColor:"#f0f0f0"}}),[h]),R=m.useMemo(()=>({...En(o,n.extra_grid_config),domLayout:s.domLayout,autoSizeStrategy:ct(i.length),onFirstDataRendered:u=>{},columnDefs:i,getRowId:y,rowModelType:"clientSide"}),[i.length,JSON.stringify(i),s,n.extra_grid_config,o,y,a]),F=m.useMemo(()=>e.data_type==="DataSource"?e.datasource:{rowCount:e.length,getRows:u=>{throw console.debug("fake datasource getRows called, unexpected"),new Error("fake datasource getRows called, unexpected")}},[e]),v=m.useMemo(()=>An(e,R,s),[e,R,s]),S=m.useRef(null),H=m.useRef(null),O=m.useMemo(()=>{try{return i.map(u=>u==null?void 0:u.field).filter(Boolean)}catch{return[]}},[i]),Ie=m.useMemo(()=>{const u=(b||[]).map(p=>O.map(_=>p==null?void 0:p[_])),C=(g||[]).map(p=>p.primary_key_val);return JSON.stringify({k:C,f:O,v:u})},[b,O,g]);m.useEffect(()=>{var u,C;try{const p=(b||[]).map(_=>({..._}));H.current=p,(C=(u=S.current)==null?void 0:u.api)==null||C.setGridOption("pinnedTopRowData",p)}catch{}},[Ie]);const q=m.useMemo(()=>e.data_type==="Raw"?JSON.stringify(e.data):null,[e]);return m.useEffect(()=>{var u;if(e.data_type==="Raw"&&((u=S.current)!=null&&u.api)&&q)try{S.current.api.setGridOption("rowData",e.data)}catch{}},[q,e.data_type,e]),w.jsx(Me,{ref:S,theme:D,loadThemeGoogleFonts:!0,gridOptions:v,defaultColDef:f,datasource:F,columnDefs:i,onGridReady:u=>{try{u.api.setGridOption("pinnedTopRowData",H.current||[])}catch{}},context:{outside_df_params:a,...l}},JSON.stringify(a)||"no-outside-params")}const An=(e,n,t)=>{if(e.data_type==="Raw")return{...n,rowData:e.data,suppressNoRowsOverlay:!0};if(e.data_type==="DataSource")return Gn(n,t.maxRowsWithoutScrolling);throw new Error(`Unexpected data_wrapper.data_type on  ${e}`)},Gn=(e,n)=>({...e,animateRows:!1,suppressNoRowsOverlay:!0,onSortChanged:r=>{const o=r.api;console.log("sortChanged",o.getFirstDisplayedRowIndex(),o.getLastDisplayedRowIndex(),r),o.ensureIndexVisible(0)},rowBuffer:20,rowModelType:"infinite",cacheBlockSize:n+50,cacheOverflowSize:0,maxConcurrentDatasourceRequests:3,maxBlocksInCache:0});function jn({df_data:e,df_viewer_config:n,summary_stats_data:t,activeCol:r,setActiveCol:o}){const c=o||(s=>{console.log("defaultSetColumnFunc",s)});return w.jsx(pe,{data_wrapper:{data_type:"Raw",data:e,length:e.length},df_viewer_config:n,summary_stats_data:t,activeCol:r,setActiveCol:c})}pe.__docgenInfo={description:"",methods:[],displayName:"DFViewerInfinite",props:{data_wrapper:{required:!0,tsType:{name:"union",raw:"DatasourceWrapper | RawDataWrapper",elements:[{name:"DatasourceWrapper"},{name:"RawDataWrapper"}]},description:""},df_viewer_config:{required:!0,tsType:{name:"DFViewerConfig"},description:""},summary_stats_data:{required:!1,tsType:{name:"Array",elements:[{name:"Record",elements:[{name:"string"},{name:"union",raw:"string | number | boolean | any[] | Record<string, any> | null",elements:[{name:"string"},{name:"number"},{name:"boolean"},{name:"Array",elements:[{name:"any"}],raw:"any[]"},{name:"Record",elements:[{name:"string"},{name:"any"}],raw:"Record<string, any>"},{name:"null"}]}],raw:`Record<
    string,
    string | number | boolean | any[] | Record<string, any> | null
>`}],raw:"DFDataRow[]"},description:""},activeCol:{required:!1,tsType:{name:"tuple",raw:"[string, string]",elements:[{name:"string"},{name:"string"}]},description:""},setActiveCol:{required:!0,tsType:{name:"signature",type:"function",raw:"(newCol: [string, string]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[string, string]",elements:[{name:"string"},{name:"string"}]},name:"newCol"}],return:{name:"void"}}},description:""},outside_df_params:{required:!1,tsType:{name:"any"},description:""},error_info:{required:!1,tsType:{name:"string"},description:""},max_rows_in_configs:{required:!1,tsType:{name:"number"},description:""}}};ye.__docgenInfo={description:"",methods:[],displayName:"DFViewerInfiniteInner",props:{data_wrapper:{required:!0,tsType:{name:"union",raw:"DatasourceWrapper | RawDataWrapper",elements:[{name:"DatasourceWrapper"},{name:"RawDataWrapper"}]},description:""},df_viewer_config:{required:!0,tsType:{name:"DFViewerConfig"},description:""},summary_stats_data:{required:!0,tsType:{name:"Array",elements:[{name:"Record",elements:[{name:"string"},{name:"union",raw:"string | number | boolean | any[] | Record<string, any> | null",elements:[{name:"string"},{name:"number"},{name:"boolean"},{name:"Array",elements:[{name:"any"}],raw:"any[]"},{name:"Record",elements:[{name:"string"},{name:"any"}],raw:"Record<string, any>"},{name:"null"}]}],raw:`Record<
    string,
    string | number | boolean | any[] | Record<string, any> | null
>`}],raw:"DFDataRow[]"},description:""},activeCol:{required:!0,tsType:{name:"tuple",raw:"[string, string]",elements:[{name:"string"},{name:"string"}]},description:""},setActiveCol:{required:!0,tsType:{name:"signature",type:"function",raw:"(newCol: [string, string]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[string, string]",elements:[{name:"string"},{name:"string"}]},name:"newCol"}],return:{name:"void"}}},description:""},outside_df_params:{required:!1,tsType:{name:"any"},description:""},renderStartTime:{required:!0,tsType:{name:"any"},description:""},hs:{required:!0,tsType:{name:"HeightStyleI"},description:""}}};jn.__docgenInfo={description:"",methods:[],displayName:"DFViewer",props:{df_data:{required:!0,tsType:{name:"Array",elements:[{name:"Record",elements:[{name:"string"},{name:"union",raw:"string | number | boolean | any[] | Record<string, any> | null",elements:[{name:"string"},{name:"number"},{name:"boolean"},{name:"Array",elements:[{name:"any"}],raw:"any[]"},{name:"Record",elements:[{name:"string"},{name:"any"}],raw:"Record<string, any>"},{name:"null"}]}],raw:`Record<
    string,
    string | number | boolean | any[] | Record<string, any> | null
>`}],raw:"DFDataRow[]"},description:""},df_viewer_config:{required:!0,tsType:{name:"DFViewerConfig"},description:""},summary_stats_data:{required:!1,tsType:{name:"Array",elements:[{name:"Record",elements:[{name:"string"},{name:"union",raw:"string | number | boolean | any[] | Record<string, any> | null",elements:[{name:"string"},{name:"number"},{name:"boolean"},{name:"Array",elements:[{name:"any"}],raw:"any[]"},{name:"Record",elements:[{name:"string"},{name:"any"}],raw:"Record<string, any>"},{name:"null"}]}],raw:`Record<
    string,
    string | number | boolean | any[] | Record<string, any> | null
>`}],raw:"DFDataRow[]"},description:""},activeCol:{required:!1,tsType:{name:"tuple",raw:"[string, string]",elements:[{name:"string"},{name:"string"}]},description:""},setActiveCol:{required:!1,tsType:{name:"signature",type:"function",raw:"(newCol: [string, string]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[string, string]",elements:[{name:"string"},{name:"string"}]},name:"newCol"}],return:{name:"void"}}},description:""}}};const Bn=e=>t=>{if(t.data.index==="histogram")return;const r=t.data[e].toString();return w.jsx("div",{className:"ag-tooltip",children:r})},Vn=e=>{if(e===void 0)return{};switch(e.tooltip_type){case"simple":return{tooltipComponent:Bn(e.val_column),tooltipField:e.val_column};case"summary_series":return{}}},wt=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:3}),J=e=>t=>{const r=t.value;if(r&&e.max_length&&typeof r=="string")try{return r.slice(0,e.max_length)}catch(o){return console.log("e",o,"val",r),""}return r},Hn=e=>`{ ${x(e,(t,r)=>`'${r}': ${V(t)}`).join(",")} }`,we=e=>!!(pn(e)&&isFinite(e.getTime())),qn={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1},Wn=e=>{const n=e.toLocaleDateString("en-CA",qn),[t,r]=n.split(",");return`${t} ${r}`},V=e=>e==null?"None":G(e)?`[ ${e.map(V).join(", ")}]`:gn(e)?De(e):He(e)?Hn(e):e.toString(),Ce=e=>t=>{const r=t.value,o=V(r);return e.max_length?o.slice(0,e.max_length):o},$n=Ce({}),De=e=>e===!0?"True":e===!1?"False":"",Un=e=>{const n=e.value;return De(n)},zn=e=>{const t=Math.floor(e.max_digits/3)+e.max_digits,r=new Intl.NumberFormat("en-US");return a=>{const c=a.value;return c===null||c===void 0?"":r.format(a.value).padStart(t," ")}},Jn=e=>{const n=new Intl.NumberFormat("en-US",{minimumFractionDigits:e.min_fraction_digits,maximumFractionDigits:e.max_fraction_digits});return t=>{if(t.value===null||t.value===void 0)return"";const r=n.format(t.value);if(k(r,".")){const o=r.split(".")[1],a=e.max_fraction_digits-o.length+r.length;return r.padEnd(a)}else{const o=r.length+e.max_fraction_digits+1;return r.padEnd(o)}}},Yn=e=>n=>{const t=n.value;if(t==null)return"";const r=new Date(t);return we(r)?r.toLocaleDateString(e.locale,e.args):""},Kn=e=>{const n=e.value;if(n==null)return"";const t=new Date(n);return we(t)?Wn(t):""};function Re(e){switch(e.displayer){case"integer":return zn(e);case"string":return J(e);case"datetimeDefault":return Kn;case"datetimeLocaleString":return Yn(e);case"float":return Jn(e);case"boolean":return Un;case"obj":return Ce(e);default:return J({displayer:"string"})}}function _e(e){switch(e.displayer){case"histogram":return Le;case"chart":return Ee(e);case"linkify":return me;case"Base64PNGImageDisplayer":return ge;case"boolean_checkbox":return"agCheckboxCellRenderer";case"SVGDisplayer":return be}}function Se(e){return k(ue,e.displayer)?void 0:Re(e)}function Zn(e){const n=Se(e);return n!==void 0?{valueFormatter:n}:k(ue,e.displayer)?{cellRenderer:_e(e)}:{}}function Qn(e,n){return x(x(n,"primary_key_val"),t=>N(e,{index:t}))}const xe=e=>B(e,"col_path")?e.field:e.col_name;function Fe(e){const n=e.color_map_config?On(e.color_map_config):{};return{field:xe(e),cellDataType:!1,cellStyle:void 0,...Zn(e.displayer_args),...n,...Vn(e.tooltip_config),...e.ag_grid_specs}}function Xn(e){return{headerName:e.header_name,...Fe(e)}}const A=(e,n)=>{const t=r=>B(r,"col_path")?r.col_path[n]:r.col_name+"!&single"+un(e,r).toString();return e.reduce((r,o)=>{const a=t(o),c=r[r.length-1];return!c||t(c[0])!==a?r.push([o]):c.push(o),r},[])};function Y(e,n){return console.log("f",e,e.ag_grid_specs),{headerName:e.col_path[n],...Fe(e)}}function ve(e,n=0){if(e.length==0)throw new Error("f shouldn't be empty");const t=e[0].col_path,r=t[n],o=t.length;if(n==o)throw new Error("something went wrong, level is too deep");const a=n+1;if(o==1){const c={children:x(e,s=>Y(s,0)),...e[0].ag_grid_specs};return console.log(" colDef from multiIndexColToColDef",c),c}if(a==o-1){const c={headerName:r,children:x(e,s=>Y(s,a)),...e[0].ag_grid_specs};return console.log(" colDef from multiIndexColToColDef",c),c}else{const c=A(e,a),s={headerName:r,children:x(c,i=>ve(i,a)),...e[0].ag_grid_specs};return console.log(" colDef from multiIndexColToColDef",s),s}}const K=e=>{if(e.length==0)throw new Error("x shouldn't be empty");if(B(e[0],"col_path"))return ve(e);if(e.length>1)throw new Error(`for NormalColumnConfig, length should be 1, improperly grouped ${e}`);return Xn(e[0])};function I(e,n,t){const r=Xe(e);return r[n]===void 0?r[n]=t:(console.log("c",r,n),G(r[n])?r[n].push(t):r[n]=[r[n],t]),r}function et(e){const o=A(e.left_col_configs,0).map(K).map(l=>I(l,"headerClass","left_col_configs_header")).map(l=>I(l,"cellClass","left_col_configs_cell"));if(o.length>0){const l=o.length-1;o[l]=I(o[l],"headerClass","left_col_configs_header_last"),o[l]=I(o[l],"cellClass","left_col_configs_cell_last")}const a=l=>({...l,pinned:"left"}),c=o.map(a);console.log("lcc3",c);const s=e.column_config,f=A(s,0).map(K);return[...o,...f]}function nt(e,n){const t={component:L($n)},r={};for(const o of n){const a=xe(o),c=Se(o.displayer_args);c&&(r[a]=c)}return o=>{var a;if(o.node.rowPinned){const c=E(o.node.data,"index");if(c===void 0)return t;const s=N(e,{primary_key_val:c});if(s===void 0)return t;const i=s,f=(a=o.column)==null?void 0:a.getColId();if(i.default_renderer_columns===void 0&&f==="index"||k(i.default_renderer_columns,f))return t;if(i.displayer_args.displayer==="inherit"){const l=f?r[f]:void 0;return l?{component:L(l)}:t}const d=_e(i.displayer_args);return d===void 0?{component:L(Re(i.displayer_args))}:{component:d}}else return}}function tt(e){const n=N(e,{index:"histogram_bins"})||{},t=N(e,{index:"histogram_log_bins"})||{},r=_n(Rn(M(n),M(t)),"index"),o=x(r,a=>({histogram_bins:E(n,a,[]),histogram_log_bins:E(t,a,[])}));return xn(r,o)}const Ct=e=>{const n=new Date;return{createTime:n,rowCount:void 0,getRows:r=>{var f;console.log("gridUtils 198 calling getRows createTime",n,new Date-n);const o=r.sortModel,a=JSON.stringify((f=r.context)==null?void 0:f.outside_df_params),c={sourceName:a,start:r.startRow,end:r.startRow+1e3,origEnd:r.endRow,sort:o.length===1?o[0].colId:void 0,sort_direction:o.length===1?o[0].sort:void 0};console.log("[getRows] dsPayloadArgs",c,"context.outside_df_params",a);const s=(d,l)=>{console.log("successWrapper called 217",n,new Date-n),r.successCallback(d,l)},i=()=>{console.log("request failed for ",c),r.failCallback()};e.getRequestRows(c,s,i)}}},rt=(e,n,t,r)=>at({numRows:n,pinnedRowLen:e,location:window.location,compC:t,rowHeight:r}),ot=()=>window.vscIPyWidgets!==void 0,at=e=>{const{numRows:n,pinnedRowLen:t,location:r,rowHeight:o,compC:a}=e,c=r.host.indexOf("colab.googleusercontent.com")!==-1,s=window.parent!==window,i=window.innerHeight/((a==null?void 0:a.height_fraction)||2),f=(a==null?void 0:a.dfvHeight)||i;console.log("314, ",i,window.innerHeight,(a==null?void 0:a.height_fraction)||2,a==null?void 0:a.dfvHeight,i,f);const d={height:f,overflow:"hidden"},l={minHeight:50,maxHeight:f,overflow:"hidden"},b=Math.floor(f/(o||21)-3),y=n+t<b;console.log("belowMinRows",y,n,t,b);const h=(a==null?void 0:a.shortMode)||y&&o===void 0;console.log("shortMode",h,a==null?void 0:a.shortMode,y,o);const D=s?"inIframe":"";if(c||ot())return{classMode:"regular-mode",domLayout:"normal",applicableStyle:{height:500},inIframe:D,maxRowsWithoutScrolling:b};const R=(a==null?void 0:a.layoutType)||(h?"autoHeight":"normal"),F=h?l:d;return console.log("351 gridUtils",h,l,d),{classMode:h?"short-mode":"regular-mode",domLayout:R,applicableStyle:F,inIframe:D,maxRowsWithoutScrolling:b}},ct=e=>e<1?{type:"fitProvidedWidth",width:window.innerWidth-100}:{type:"fitCellContents"},Te={spacing:5,cellHorizontalPaddingScale:.3,columnBorder:!0,rowBorder:!1,rowVerticalPaddingScale:.5,wrapperBorder:!1,fontSize:12,dataFontSize:"12px",headerFontSize:14,iconSize:10,headerVerticalPaddingScale:.6},st=X.withPart(Pe).withParams({...Te,browserColorScheme:"dark",backgroundColor:"#181D1F",oddRowBackgroundColor:"#222628"}),it=X.withPart(Oe).withParams({...Te,browserColorScheme:"light",backgroundColor:"#ffffff",oddRowBackgroundColor:"#f5f5f5"});function lt(e){return e==="light"?it:st}export{jn as D,yt as E,pe as a,wt as b,lt as c,un as d,xe as e,Ct as g,B as h,k as i};
