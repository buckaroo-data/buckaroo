import{j as T}from"./jsx-runtime-DiklIkkE.js";import{r as P}from"./index-DRjF_FHU.js";import{C as qe,b as ke}from"./ColumnsEditor-Af2vXjS1.js";import{S as Fe}from"./StatusBar-CHi4aAIO.js";import{g as Ye,a as je}from"./gridUtils-DsHN3qVl.js";import"./lodash-CGIzQN7T.js";import"./MessageBox-DZJPuPgI.js";import{K as $e}from"./SmartRowCache-UN4kgxXg.js";import"./Operations-Xk-4uWct.js";import"./OperationsList-CPVzoTey.js";import"./main.esm-B8BDqAWP.js";import"./index-Bx0Ph3cE.js";import"./HistogramCell-CrXfgV_n.js";import"./ChartCell-ClfxlV_N.js";import"./tiny-invariant-CopsF_GD.js";const te=["BOOLEAN","INT32","INT64","INT96","FLOAT","DOUBLE","BYTE_ARRAY","FIXED_LEN_BYTE_ARRAY"],O=["PLAIN","GROUP_VAR_INT","PLAIN_DICTIONARY","RLE","BIT_PACKED","DELTA_BINARY_PACKED","DELTA_LENGTH_BYTE_ARRAY","DELTA_BYTE_ARRAY","RLE_DICTIONARY","BYTE_STREAM_SPLIT"],Ve=["REQUIRED","OPTIONAL","REPEATED"],ze=["UTF8","MAP","MAP_KEY_VALUE","LIST","ENUM","DECIMAL","DATE","TIME_MILLIS","TIME_MICROS","TIMESTAMP_MILLIS","TIMESTAMP_MICROS","UINT_8","UINT_16","UINT_32","UINT_64","INT_8","INT_16","INT_32","INT_64","JSON","BSON","INTERVAL"],We=["UNCOMPRESSED","SNAPPY","GZIP","LZO","BROTLI","LZ4","ZSTD","LZ4_RAW"],ge=["DATA_PAGE","INDEX_PAGE","DICTIONARY_PAGE","DATA_PAGE_V2"],we=864e5;function ne(e,t,n,i,r=!0){if(t&&i.endsWith("_DICTIONARY")){let s=e;e instanceof Uint8Array&&!(t instanceof Uint8Array)&&(s=new t.constructor(e.length));for(let f=0;f<e.length;f++)s[f]=t[e[f]];return s}else return pe(e,n,r)}function pe(e,t,n=!0){var r,s;const i=t.converted_type;if(i==="DECIMAL"){const o=10**-(t.scale||0),a=new Array(e.length);for(let l=0;l<a.length;l++)e[0]instanceof Uint8Array?a[l]=he(e[l])*o:a[l]=Number(e[l])*o;return a}if(i===void 0&&t.type==="INT96")return Array.from(e).map(Ze);if(i==="DATE"){const f=new Array(e.length);for(let o=0;o<f.length;o++)f[o]=new Date(e[o]*we);return f}if(i==="TIMESTAMP_MILLIS"){const f=new Array(e.length);for(let o=0;o<f.length;o++)f[o]=new Date(Number(e[o]));return f}if(i==="TIMESTAMP_MICROS"){const f=new Array(e.length);for(let o=0;o<f.length;o++)f[o]=new Date(Number(e[o]/1000n));return f}if(i==="JSON"){const f=new TextDecoder;return e.map(o=>JSON.parse(f.decode(o)))}if(i==="BSON")throw new Error("parquet bson not supported");if(i==="INTERVAL")throw new Error("parquet interval not supported");if(i==="UTF8"||n&&t.type==="BYTE_ARRAY"){const f=new TextDecoder,o=new Array(e.length);for(let a=0;a<o.length;a++)o[a]=e[a]&&f.decode(e[a]);return o}if(i==="UINT_64"){const f=new BigUint64Array(e.length);for(let o=0;o<f.length;o++)f[o]=BigInt(e[o]);return f}if(((r=t.logical_type)==null?void 0:r.type)==="FLOAT16")return Array.from(e).map(ye);if(((s=t.logical_type)==null?void 0:s.type)==="TIMESTAMP"){const{unit:f}=t.logical_type;let o=1n;f==="MICROS"&&(o=1000n),f==="NANOS"&&(o=1000000n);const a=new Array(e.length);for(let l=0;l<a.length;l++)a[l]=new Date(Number(e[l]/o));return a}return e}function he(e){let t=0;for(const i of e)t=t*256+i;const n=e.length*8;return t>=2**(n-1)&&(t-=2**n),t}function Ze(e){const t=Number((e>>64n)-2440588n),n=Number((e&0xffffffffffffffffn)/1000000n),i=t*we+n;return new Date(i)}function ye(e){if(!e)return;const t=e[1]<<8|e[0],n=t>>15?-1:1,i=t>>10&31,r=t&1023;return i===0?n*2**-14*(r/1024):i===31?r?NaN:n*(1/0):n*2**(i-15)*(1+r/1024)}function Ae(e,t,n){const i=e[t],r=[];let s=1;if(i.num_children)for(;r.length<i.num_children;){const f=e[t+s],o=Ae(e,t+s,[...n,f.name]);s+=o.count,r.push(o)}return{count:s,element:i,children:r,path:n}}function re(e,t){let n=Ae(e,0,[]);const i=[n];for(const r of t){const s=n.children.find(f=>f.element.name===r);if(!s)throw new Error(`parquet schema element not found: ${t}`);i.push(s),n=s}return i}function be(e){let t=0;for(const{element:n}of e)n.repetition_type==="REPEATED"&&t++;return t}function J(e){let t=0;for(const{element:n}of e.slice(1))n.repetition_type!=="REQUIRED"&&t++;return t}function Ge(e){if(!e||e.element.converted_type!=="LIST"||e.children.length>1)return!1;const t=e.children[0];return!(t.children.length>1||t.element.repetition_type!=="REPEATED")}function Ke(e){if(!e||e.element.converted_type!=="MAP"||e.children.length>1)return!1;const t=e.children[0];if(t.children.length!==2||t.element.repetition_type!=="REPEATED")return!1;const n=t.children.find(r=>r.element.name==="key");if((n==null?void 0:n.element.repetition_type)==="REPEATED")return!1;const i=t.children.find(r=>r.element.name==="value");return(i==null?void 0:i.element.repetition_type)!=="REPEATED"}function Qe(e){if(e.length!==2)return!1;const[,t]=e;return!(t.element.repetition_type==="REPEATED"||t.children.length)}const S={STOP:0,TRUE:1,FALSE:2,BYTE:3,I16:4,I32:5,I64:6,DOUBLE:7,BINARY:8,LIST:9,STRUCT:12};function Ee(e){let t=0;const n={};for(;e.offset<e.view.byteLength;){const[i,r,s]=Ie(e,t);if(t=s,i===S.STOP)break;n[`field_${r}`]=j(e,i)}return n}function j(e,t){switch(t){case S.TRUE:return!0;case S.FALSE:return!1;case S.BYTE:return e.view.getInt8(e.offset++);case S.I16:case S.I32:return Xe(e);case S.I64:return G(e);case S.DOUBLE:{const n=e.view.getFloat64(e.offset,!0);return e.offset+=8,n}case S.BINARY:{const n=B(e),i=new Uint8Array(e.view.buffer,e.view.byteOffset+e.offset,n);return e.offset+=n,i}case S.LIST:{const[n,i]=He(e),r=n===S.TRUE||n===S.FALSE,s=new Array(i);for(let f=0;f<i;f++)s[f]=r?j(e,S.BYTE)===1:j(e,n);return s}case S.STRUCT:{const n={};let i=0;for(;;){let r,s;if([r,s,i]=Ie(e,i),r===S.STOP)break;n[`field_${s}`]=j(e,r)}return n}default:throw new Error(`thrift unhandled type: ${t}`)}}function B(e){let t=0,n=0;for(;;){const i=e.view.getUint8(e.offset++);if(t|=(i&127)<<n,!(i&128))return t;n+=7}}function Je(e){let t=0n,n=0n;for(;;){const i=e.view.getUint8(e.offset++);if(t|=BigInt(i&127)<<n,!(i&128))return t;n+=7n}}function Xe(e){const t=B(e);return t>>>1^-(t&1)}function G(e){const t=Je(e);return t>>1n^-(t&1n)}function Se(e){return e&15}function Ie(e,t){const n=e.view.getUint8(e.offset++);if((n&15)===S.STOP)return[0,0,t];const i=n>>4;let r;if(i)r=t+i;else throw new Error("non-delta field id not supported");return[Se(n),r,r]}function He(e){const t=e.view.getUint8(e.offset++),n=t>>4,i=Se(t);if(n===15){const r=B(e);return[i,r]}return[i,n]}const et=1<<19;async function tt(e,t=et){if(!e||!(e.byteLength>=0))throw new Error("parquetMetadataAsync expected AsyncBuffer");const n=Math.max(0,e.byteLength-t),i=await e.slice(n,e.byteLength),r=new DataView(i);if(r.getUint32(i.byteLength-4,!0)!==827474256)throw new Error("parquet file invalid (footer != PAR1)");const s=r.getUint32(i.byteLength-8,!0);if(s>e.byteLength-8)throw new Error(`parquet metadata length ${s} exceeds available buffer ${e.byteLength-8}`);if(s+8>t){const f=e.byteLength-s-8,o=await e.slice(f,n),a=new ArrayBuffer(s+8),l=new Uint8Array(a);return l.set(new Uint8Array(o)),l.set(new Uint8Array(i),n-f),K(a)}else return K(i)}function K(e){var h;if(!(e instanceof ArrayBuffer))throw new Error("parquetMetadata expected ArrayBuffer");const t=new DataView(e);if(t.byteLength<8)throw new Error("parquet file is too short");if(t.getUint32(t.byteLength-4,!0)!==827474256)throw new Error("parquet file invalid (footer != PAR1)");const n=t.byteLength-8,i=t.getUint32(n,!0);if(i>t.byteLength-8)throw new Error(`parquet metadata length ${i} exceeds available buffer ${t.byteLength-8}`);const r=n-i,f=Ee({view:t,offset:r}),o=new TextDecoder;function a(m){return m&&o.decode(m)}const l=f.field_1,u=f.field_2.map(m=>({type:te[m.field_1],type_length:m.field_2,repetition_type:Ve[m.field_3],name:a(m.field_4),num_children:m.field_5,converted_type:ze[m.field_6],scale:m.field_7,precision:m.field_8,field_id:m.field_9,logical_type:nt(m.field_10)})),c=u.filter(m=>m.type),_=f.field_3,d=f.field_4.map(m=>{var y;return{columns:m.field_1.map((g,b)=>{var A,I;return{file_path:a(g.field_1),file_offset:g.field_2,meta_data:g.field_3&&{type:te[g.field_3.field_1],encodings:(A=g.field_3.field_2)==null?void 0:A.map(v=>O[v]),path_in_schema:g.field_3.field_3.map(a),codec:We[g.field_3.field_4],num_values:g.field_3.field_5,total_uncompressed_size:g.field_3.field_6,total_compressed_size:g.field_3.field_7,key_value_metadata:g.field_3.field_8,data_page_offset:g.field_3.field_9,index_page_offset:g.field_3.field_10,dictionary_page_offset:g.field_3.field_11,statistics:rt(g.field_3.field_12,c[b]),encoding_stats:(I=g.field_3.field_13)==null?void 0:I.map(v=>({page_type:ge[v.field_1],encoding:O[v.field_2],count:v.field_3})),bloom_filter_offset:g.field_3.field_14,bloom_filter_length:g.field_3.field_15,size_statistics:g.field_3.field_16&&{unencoded_byte_array_data_bytes:g.field_3.field_16.field_1,repetition_level_histogram:g.field_3.field_16.field_2,definition_level_histogram:g.field_3.field_16.field_3}},offset_index_offset:g.field_4,offset_index_length:g.field_5,column_index_offset:g.field_6,column_index_length:g.field_7,crypto_metadata:g.field_8,encrypted_column_metadata:g.field_9}}),total_byte_size:m.field_2,num_rows:m.field_3,sorting_columns:(y=m.field_4)==null?void 0:y.map(g=>({column_idx:g.field_1,descending:g.field_2,nulls_first:g.field_3})),file_offset:m.field_5,total_compressed_size:m.field_6,ordinal:m.field_7}}),w=(h=f.field_5)==null?void 0:h.map(m=>({key:a(m.field_1),value:a(m.field_2)})),p=a(f.field_6);return{version:l,schema:u,num_rows:_,row_groups:d,key_value_metadata:w,created_by:p,metadata_length:i}}function nt(e){return e!=null&&e.field_1?{type:"STRING"}:e!=null&&e.field_2?{type:"MAP"}:e!=null&&e.field_3?{type:"LIST"}:e!=null&&e.field_4?{type:"ENUM"}:e!=null&&e.field_5?{type:"DECIMAL",scale:e.field_5.field_1,precision:e.field_5.field_2}:e!=null&&e.field_6?{type:"DATE"}:e!=null&&e.field_7?{type:"TIME",isAdjustedToUTC:e.field_7.field_1,unit:ie(e.field_7.field_2)}:e!=null&&e.field_8?{type:"TIMESTAMP",isAdjustedToUTC:e.field_8.field_1,unit:ie(e.field_8.field_2)}:e!=null&&e.field_10?{type:"INTEGER",bitWidth:e.field_10.field_1,isSigned:e.field_10.field_2}:e!=null&&e.field_11?{type:"NULL"}:e!=null&&e.field_12?{type:"JSON"}:e!=null&&e.field_13?{type:"BSON"}:e!=null&&e.field_14?{type:"UUID"}:e!=null&&e.field_15?{type:"FLOAT16"}:e}function ie(e){if(e.field_1)return"MILLIS";if(e.field_2)return"MICROS";if(e.field_3)return"NANOS";throw new Error("parquet time unit required")}function rt(e,t){return e&&{max:F(e.field_1,t),min:F(e.field_2,t),null_count:e.field_3,distinct_count:e.field_4,max_value:F(e.field_5,t),min_value:F(e.field_6,t),is_max_value_exact:e.field_7,is_min_value_exact:e.field_8}}function F(e,t){const{type:n,converted_type:i,logical_type:r}=t;if(e===void 0)return e;if(n==="BOOLEAN")return e[0]===1;if(n==="BYTE_ARRAY")return new TextDecoder().decode(e);const s=new DataView(e.buffer,e.byteOffset,e.byteLength);return n==="FLOAT"&&s.byteLength===4?s.getFloat32(0,!0):n==="DOUBLE"&&s.byteLength===8?s.getFloat64(0,!0):n==="INT32"&&i==="DATE"?new Date(s.getInt32(0,!0)*864e5):n==="INT64"&&i==="TIMESTAMP_MICROS"?new Date(Number(s.getBigInt64(0,!0)/1000n)):n==="INT64"&&i==="TIMESTAMP_MILLIS"?new Date(Number(s.getBigInt64(0,!0))):n==="INT64"&&(r==null?void 0:r.type)==="TIMESTAMP"&&(r==null?void 0:r.unit)==="NANOS"?new Date(Number(s.getBigInt64(0,!0)/1000000n)):n==="INT64"&&(r==null?void 0:r.type)==="TIMESTAMP"&&(r==null?void 0:r.unit)==="MICROS"?new Date(Number(s.getBigInt64(0,!0)/1000n)):n==="INT64"&&(r==null?void 0:r.type)==="TIMESTAMP"?new Date(Number(s.getBigInt64(0,!0))):n==="INT32"&&s.byteLength===4?s.getInt32(0,!0):n==="INT64"&&s.byteLength===8?s.getBigInt64(0,!0):i==="DECIMAL"?he(e)*10**-(t.scale||0):(r==null?void 0:r.type)==="FLOAT16"?ye(e):e}function se(e,t,n,i,r){const s=(t==null?void 0:t.length)||n.length;if(!s)return i;const f=J(r),o=r.map(({element:w})=>w.repetition_type);let a=0;const l=[e];let u=e,c=0,_=0,d=0;if(n[0])for(;c<o.length-2&&d<n[0];){if(!u)throw new Error("parquet cannot resume previous page");u=u.at(-1),l.push(u),c++,o[c]!=="REQUIRED"&&_++,o[c]==="REPEATED"&&d++}for(let w=0;w<s;w++){const p=t!=null&&t.length?t[w]:f,h=n[w];for(;c&&(h<d||o[c]!=="REPEATED");)o[c]!=="REQUIRED"&&(l.pop(),_--),o[c]==="REPEATED"&&d--,c--;for(u=l.at(-1);(c<o.length-2||o[c+1]==="REPEATED")&&(_<p||o[c+1]==="REQUIRED");){if(c++,o[c]!=="REQUIRED"){const m=[];u.push(m),u=m,l.push(m),_++}o[c]==="REPEATED"&&d++}p===f?u.push(i[a++]):c===o.length-2?u.push(null):u.push([])}if(!e.length)for(let w=0;w<f;w++){const p=[];u.push(p),u=p}return e}function U(e,t,n=0){const i=t.path.join("."),r=t.element.repetition_type==="OPTIONAL",s=r?n+1:n;if(Ge(t)){let f=t.children[0],o=s;f.children.length===1&&(f=f.children[0],o++),U(e,f,o);const a=f.path.join("."),l=e.get(a);if(!l)throw new Error("parquet list column missing values");r&&$(l,n),e.set(i,l),e.delete(a);return}if(Ke(t)){const f=t.children[0].element.name;U(e,t.children[0].children[0],s+1),U(e,t.children[0].children[1],s+1);const o=e.get(`${i}.${f}.key`),a=e.get(`${i}.${f}.value`);if(!o)throw new Error("parquet map column missing keys");if(!a)throw new Error("parquet map column missing values");if(o.length!==a.length)throw new Error("parquet map column key/value length mismatch");const l=ve(o,a,s);r&&$(l,n),e.delete(`${i}.${f}.key`),e.delete(`${i}.${f}.value`),e.set(i,l);return}if(t.children.length){const f=t.element.repetition_type==="REQUIRED"?n:n+1,o={};for(const l of t.children){U(e,l,f);const u=e.get(l.path.join("."));if(!u)throw new Error("parquet struct missing child data");o[l.element.name]=u}for(const l of t.children)e.delete(l.path.join("."));const a=Re(o,f);r&&$(a,n),e.set(i,a)}}function $(e,t){for(let n=0;n<e.length;n++)t?$(e[n],t-1):e[n]=e[n][0]}function ve(e,t,n){const i=[];for(let r=0;r<e.length;r++)if(n)i.push(ve(e[r],t[r],n-1));else if(e[r]){const s={};for(let f=0;f<e[r].length;f++){const o=t[r][f];s[e[r][f]]=o===void 0?null:o}i.push(s)}else i.push(void 0);return i}function Re(e,t){var s;const n=Object.keys(e),i=(s=e[n[0]])==null?void 0:s.length,r=[];for(let f=0;f<i;f++){const o={};for(const a of n){if(e[a].length!==i)throw new Error("parquet struct parsing error");o[a]=e[a][f]}t?r.push(Re(o,t-1)):r.push(o)}return r}function V(e,t,n){const i=n instanceof Int32Array,r=B(e),s=B(e);B(e);let f=G(e),o=0;n[o++]=i?Number(f):f;const a=r/s;for(;o<t;){const l=G(e),u=new Uint8Array(s);for(let c=0;c<s;c++)u[c]=e.view.getUint8(e.offset++);for(let c=0;c<s&&o<t;c++){const _=BigInt(u[c]);if(_){let d=0n,w=a;const p=(1n<<_)-1n;for(;w&&o<t;){let h=BigInt(e.view.getUint8(e.offset))>>d&p;for(d+=_;d>=8;)d-=8n,e.offset++,d&&(h|=BigInt(e.view.getUint8(e.offset))<<_-d&p);const m=l+h;f+=m,n[o++]=i?Number(f):f,w--}w&&(e.offset+=Math.ceil((w*Number(_)+Number(d))/8))}else for(let d=0;d<a&&o<t;d++)f+=l,n[o++]=i?Number(f):f}}}function it(e,t,n){const i=new Int32Array(t);V(e,t,i);for(let r=0;r<t;r++)n[r]=new Uint8Array(e.view.buffer,e.view.byteOffset+e.offset,i[r]),e.offset+=i[r]}function st(e,t,n){const i=new Int32Array(t);V(e,t,i);const r=new Int32Array(t);V(e,t,r);for(let s=0;s<t;s++){const f=new Uint8Array(e.view.buffer,e.view.byteOffset+e.offset,r[s]);i[s]?(n[s]=new Uint8Array(i[s]+r[s]),n[s].set(n[s-1].subarray(0,i[s])),n[s].set(f,i[s])):n[s]=f,e.offset+=r[s]}}function z(e){return 32-Math.clz32(e)}function L(e,t,n,i){n||(e.offset+=4);let r=0;for(;r<i.length;){const s=B(e);if(s&1)r=ft(e,s,t,i,r);else{const f=s>>>1;ot(e,f,t,i,r),r+=f}}}function ot(e,t,n,i,r){const s=n+7>>3;let f=0;for(let o=0;o<s;o++)f|=e.view.getUint8(e.offset++)<<(o<<3);for(let o=0;o<t;o++)i[r+o]=f}function ft(e,t,n,i,r){let s=t>>1<<3;const f=(1<<n)-1;let o=0;if(e.offset<e.view.byteLength)o=e.view.getUint8(e.offset++);else if(f)throw new Error(`parquet bitpack offset ${e.offset} out of range`);let a=8,l=0;for(;s;)l>8?(l-=8,a-=8,o>>>=8):a-l<n?(o|=e.view.getUint8(e.offset)<<a,e.offset++,a+=8):(r<i.length&&(i[r++]=o>>l&f),s--,l+=n);return r}function De(e,t,n,i){const r=at(n,i),s=new Uint8Array(t*r);for(let f=0;f<r;f++)for(let o=0;o<t;o++)s[o*r+f]=e.view.getUint8(e.offset++);if(n==="FLOAT")return new Float32Array(s.buffer);if(n==="DOUBLE")return new Float64Array(s.buffer);if(n==="INT32")return new Int32Array(s.buffer);if(n==="INT64")return new BigInt64Array(s.buffer);if(n==="FIXED_LEN_BYTE_ARRAY"){const f=new Array(t);for(let o=0;o<t;o++)f[o]=s.subarray(o*r,(o+1)*r);return f}throw new Error(`parquet byte_stream_split unsupported type: ${n}`)}function at(e,t){switch(e){case"INT32":case"FLOAT":return 4;case"INT64":case"DOUBLE":return 8;case"FIXED_LEN_BYTE_ARRAY":if(!t)throw new Error("parquet byteWidth missing type_length");return t;default:throw new Error(`parquet unsupported type: ${e}`)}}function X(e,t,n,i){if(n===0)return[];if(t==="BOOLEAN")return lt(e,n);if(t==="INT32")return ut(e,n);if(t==="INT64")return ct(e,n);if(t==="INT96")return mt(e,n);if(t==="FLOAT")return dt(e,n);if(t==="DOUBLE")return _t(e,n);if(t==="BYTE_ARRAY")return gt(e,n);if(t==="FIXED_LEN_BYTE_ARRAY"){if(!i)throw new Error("parquet missing fixed length");return wt(e,n,i)}else throw new Error(`parquet unhandled type: ${t}`)}function lt(e,t){const n=new Array(t);for(let i=0;i<t;i++){const r=e.offset+(i/8|0),s=i%8,f=e.view.getUint8(r);n[i]=(f&1<<s)!==0}return e.offset+=Math.ceil(t/8),n}function ut(e,t){const n=(e.view.byteOffset+e.offset)%4?new Int32Array(W(e.view.buffer,e.view.byteOffset+e.offset,t*4)):new Int32Array(e.view.buffer,e.view.byteOffset+e.offset,t);return e.offset+=t*4,n}function ct(e,t){const n=(e.view.byteOffset+e.offset)%8?new BigInt64Array(W(e.view.buffer,e.view.byteOffset+e.offset,t*8)):new BigInt64Array(e.view.buffer,e.view.byteOffset+e.offset,t);return e.offset+=t*8,n}function mt(e,t){const n=new Array(t);for(let i=0;i<t;i++){const r=e.view.getBigInt64(e.offset+i*12,!0),s=e.view.getInt32(e.offset+i*12+8,!0);n[i]=BigInt(s)<<64n|r}return e.offset+=t*12,n}function dt(e,t){const n=(e.view.byteOffset+e.offset)%4?new Float32Array(W(e.view.buffer,e.view.byteOffset+e.offset,t*4)):new Float32Array(e.view.buffer,e.view.byteOffset+e.offset,t);return e.offset+=t*4,n}function _t(e,t){const n=(e.view.byteOffset+e.offset)%8?new Float64Array(W(e.view.buffer,e.view.byteOffset+e.offset,t*8)):new Float64Array(e.view.buffer,e.view.byteOffset+e.offset,t);return e.offset+=t*8,n}function gt(e,t){const n=new Array(t);for(let i=0;i<t;i++){const r=e.view.getUint32(e.offset,!0);e.offset+=4,n[i]=new Uint8Array(e.view.buffer,e.view.byteOffset+e.offset,r),e.offset+=r}return n}function wt(e,t,n){const i=new Array(t);for(let r=0;r<t;r++)i[r]=new Uint8Array(e.view.buffer,e.view.byteOffset+e.offset,n),e.offset+=n;return i}function W(e,t,n){const i=new ArrayBuffer(n);return new Uint8Array(i).set(new Uint8Array(e,t,n)),i}const pt=[0,255,65535,16777215,4294967295];function oe(e,t,n,i,r){for(let s=0;s<r;s++)n[i+s]=e[t+s]}function ht(e,t){const n=e.byteLength,i=t.byteLength;let r=0,s=0;for(;r<n;){const f=e[r];if(r++,f<128)break}if(i&&r>=n)throw new Error("invalid snappy length header");for(;r<n;){const f=e[r];let o=0;if(r++,r>=n)throw new Error("missing eof marker");if(f&3){let a=0;switch(f&3){case 1:o=(f>>>2&7)+4,a=e[r]+(f>>>5<<8),r++;break;case 2:if(n<=r+1)throw new Error("snappy error end of input");o=(f>>>2)+1,a=e[r]+(e[r+1]<<8),r+=2;break;case 3:if(n<=r+3)throw new Error("snappy error end of input");o=(f>>>2)+1,a=e[r]+(e[r+1]<<8)+(e[r+2]<<16)+(e[r+3]<<24),r+=4;break}if(a===0||isNaN(a))throw new Error(`invalid offset ${a} pos ${r} inputLength ${n}`);if(a>s)throw new Error("cannot copy from before start of buffer");oe(t,s-a,t,s,o),s+=o}else{let a=(f>>>2)+1;if(a>60){if(r+3>=n)throw new Error("snappy error literal pos + 3 >= inputLength");const l=a-60;a=e[r]+(e[r+1]<<8)+(e[r+2]<<16)+(e[r+3]<<24),a=(a&pt[l])+1,r+=l}if(r+a>n)throw new Error("snappy error literal exceeds input length");oe(e,r,t,s,a),r+=a,s+=a}}if(s!==i)throw new Error("premature end of input")}function yt(e,t,{type:n,element:i,schemaPath:r}){const s=new DataView(e.buffer,e.byteOffset,e.byteLength),f={view:s,offset:0};let o;const a=At(f,t,r),{definitionLevels:l,numNulls:u}=bt(f,t,r),c=t.num_values-u;if(t.encoding==="PLAIN")o=X(f,n,c,i.type_length);else if(t.encoding==="PLAIN_DICTIONARY"||t.encoding==="RLE_DICTIONARY"||t.encoding==="RLE"){const _=n==="BOOLEAN"?1:s.getUint8(f.offset++);_?(o=new Array(c),n==="BOOLEAN"?(L(f,_,0,o),o=o.map(d=>!!d)):L(f,_,s.byteLength-f.offset,o)):o=new Uint8Array(c)}else if(t.encoding==="BYTE_STREAM_SPLIT")o=De(f,c,n,i.type_length);else throw new Error(`parquet unsupported encoding: ${t.encoding}`);return{definitionLevels:l,repetitionLevels:a,dataPage:o}}function At(e,t,n){if(n.length>1){const i=be(n);if(i){const r=new Array(t.num_values);return L(e,z(i),0,r),r}}return[]}function bt(e,t,n){const i=J(n);if(!i)return{definitionLevels:[],numNulls:0};const r=new Array(t.num_values);L(e,z(i),0,r);let s=t.num_values;for(const f of r)f===i&&s--;return s===0&&(r.length=0),{definitionLevels:r,numNulls:s}}function Q(e,t,n,i){let r;const s=i==null?void 0:i[n];if(n==="UNCOMPRESSED")r=e;else if(s)r=s(e,t);else if(n==="SNAPPY")r=new Uint8Array(t),ht(e,r);else throw new Error(`parquet unsupported compression codec: ${n}`);if((r==null?void 0:r.length)!==t)throw new Error(`parquet decompressed page length ${r==null?void 0:r.length} does not match header ${t}`);return r}function Et(e,t,n){const r={view:new DataView(e.buffer,e.byteOffset,e.byteLength),offset:0},{type:s,element:f,schemaPath:o,codec:a,compressors:l}=n,u=t.data_page_header_v2;if(!u)throw new Error("parquet data page header v2 is undefined");const c=St(r,u,o);r.offset=u.repetition_levels_byte_length;const _=It(r,u,o),d=t.uncompressed_page_size-u.definition_levels_byte_length-u.repetition_levels_byte_length;let w=e.subarray(r.offset);u.is_compressed!==!1&&(w=Q(w,d,a,l));const p=new DataView(w.buffer,w.byteOffset,w.byteLength),h={view:p,offset:0};let m;const y=u.num_values-u.num_nulls;if(u.encoding==="PLAIN")m=X(h,s,y,f.type_length);else if(u.encoding==="RLE")m=new Array(y),L(h,1,0,m),m=m.map(g=>!!g);else if(u.encoding==="PLAIN_DICTIONARY"||u.encoding==="RLE_DICTIONARY"){const g=p.getUint8(h.offset++);m=new Array(y),L(h,g,d-1,m)}else if(u.encoding==="DELTA_BINARY_PACKED")m=s==="INT32"?new Int32Array(y):new BigInt64Array(y),V(h,y,m);else if(u.encoding==="DELTA_LENGTH_BYTE_ARRAY")m=new Array(y),it(h,y,m);else if(u.encoding==="DELTA_BYTE_ARRAY")m=new Array(y),st(h,y,m);else if(u.encoding==="BYTE_STREAM_SPLIT")m=De(r,y,s,f.type_length);else throw new Error(`parquet unsupported encoding: ${u.encoding}`);return{definitionLevels:_,repetitionLevels:c,dataPage:m}}function St(e,t,n){const i=be(n);if(!i)return[];const r=new Array(t.num_values);return L(e,z(i),t.repetition_levels_byte_length,r),r}function It(e,t,n){const i=J(n);if(i){const r=new Array(t.num_values);return L(e,z(i),t.definition_levels_byte_length,r),r}}function vt(e,{groupStart:t,selectStart:n,selectEnd:i},r,s){const{columnName:f,element:o,utf8:a}=r,l=[];let u,c,_=0;const d=s&&(()=>{c&&s({columnName:f,columnData:c,rowStart:t+_-c.length,rowEnd:t+_})});for(;_<i&&!(e.offset>=e.view.byteLength-1);){const w=Rt(e);if(w.type==="DICTIONARY_PAGE")u=fe(e,w,r,u,void 0,0),u=pe(u,o,a);else{const p=(c==null?void 0:c.length)||0,h=fe(e,w,r,u,c,n-_);c===h?_+=h.length-p:(d==null||d(),l.push(h),_+=h.length,c=h)}}return d==null||d(),_>i&&c&&(l[l.length-1]=c.slice(0,i-(_-c.length))),l}function fe(e,t,n,i,r,s){const{type:f,element:o,schemaPath:a,codec:l,compressors:u,utf8:c}=n,_=new Uint8Array(e.view.buffer,e.view.byteOffset+e.offset,t.compressed_page_size);if(e.offset+=t.compressed_page_size,t.type==="DATA_PAGE"){const d=t.data_page_header;if(!d)throw new Error("parquet data page header is undefined");if(s>d.num_values&&Qe(a))return new Array(d.num_values);const w=Q(_,Number(t.uncompressed_page_size),l,u),{definitionLevels:p,repetitionLevels:h,dataPage:m}=yt(w,d,n);let y=ne(m,i,o,d.encoding,c);if(h.length||p!=null&&p.length){const g=Array.isArray(r)?r:[];return se(g,p,h,y,a)}else{for(let g=2;g<a.length;g++)a[g].element.repetition_type!=="REQUIRED"&&(y=Array.from(y,b=>[b]));return y}}else if(t.type==="DATA_PAGE_V2"){const d=t.data_page_header_v2;if(!d)throw new Error("parquet data page header v2 is undefined");if(s>d.num_rows)return new Array(d.num_values);const{definitionLevels:w,repetitionLevels:p,dataPage:h}=Et(_,t,n),m=ne(h,i,o,d.encoding,c),y=Array.isArray(r)?r:[];return se(y,w,p,m,a)}else if(t.type==="DICTIONARY_PAGE"){const d=t.dictionary_page_header;if(!d)throw new Error("parquet dictionary page header is undefined");const w=Q(_,Number(t.uncompressed_page_size),l,u),p={view:new DataView(w.buffer,w.byteOffset,w.byteLength),offset:0};return X(p,f,d.num_values,o.type_length)}else throw new Error(`parquet unsupported page type: ${t.type}`)}function ae({dictionary_page_offset:e,data_page_offset:t,total_compressed_size:n}){const i=e||t;return[i,i+n]}function Rt(e){const t=Ee(e),n=ge[t.field_1],i=t.field_2,r=t.field_3,s=t.field_4,f=t.field_5&&{num_values:t.field_5.field_1,encoding:O[t.field_5.field_2],definition_level_encoding:O[t.field_5.field_3],repetition_level_encoding:O[t.field_5.field_4],statistics:t.field_5.field_5&&{max:t.field_5.field_5.field_1,min:t.field_5.field_5.field_2,null_count:t.field_5.field_5.field_3,distinct_count:t.field_5.field_5.field_4,max_value:t.field_5.field_5.field_5,min_value:t.field_5.field_5.field_6}},o=t.field_6,a=t.field_7&&{num_values:t.field_7.field_1,encoding:O[t.field_7.field_2],is_sorted:t.field_7.field_3},l=t.field_8&&{num_values:t.field_8.field_1,num_nulls:t.field_8.field_2,num_rows:t.field_8.field_3,encoding:O[t.field_8.field_4],definition_levels_byte_length:t.field_8.field_5,repetition_levels_byte_length:t.field_8.field_6,is_compressed:t.field_8.field_7===void 0?!0:t.field_8.field_7,statistics:t.field_8.field_8};return{type:n,uncompressed_page_size:i,compressed_page_size:r,crc:s,data_page_header:f,index_page_header:o,dictionary_page_header:a,data_page_header_v2:l}}function Te(e,t){for(let i=0;i<t.length;i+=1e4)e.push(...t.slice(i,i+1e4))}async function Dt(e){if(!e.file||!(e.file.byteLength>=0))throw new Error("parquetRead expected file AsyncBuffer");const t=e.rowStart||0;if(t<0)throw new Error("parquetRead rowStart must be postive");if(e.metadata||(e.metadata=await tt(e.file)),!e.metadata)throw new Error("parquet metadata not found");const{metadata:n,onComplete:i,rowEnd:r}=e,s=[];let f=0;for(const o of n.row_groups){const a=Number(o.num_rows);if(f+a>=t&&(r===void 0||f<r)){const l=await Tt(e,o,f);if(i){const u=Math.max(t-f,0),c=r===void 0?void 0:r-f;Te(s,l.slice(u,c))}}f+=a}i&&i(s)}async function Tt(e,t,n){var g;const{file:i,metadata:r,columns:s,rowStart:f,rowEnd:o}=e;if(!r)throw new Error("parquet metadata not found");const a=Number(t.num_rows),l=Math.max((f||0)-n,0),u=Math.min((o??1/0)-n,a),c={groupStart:n,selectStart:l,selectEnd:u};let[_,d]=[i.byteLength,0];for(const{meta_data:b}of t.columns){if(!b)throw new Error("parquet column metadata is undefined");if(s&&!s.includes(b.path_in_schema[0]))continue;const[A,I]=ae(b).map(Number);_=Math.min(_,A),d=Math.max(d,I)}if(_>=d&&(s!=null&&s.length))throw new Error(`parquet columns not found: ${s.join(", ")}`);let w;d-_<=1<<25&&(w=await i.slice(_,d));const p=[],{children:h}=re(r.schema,[])[0],m=new Map(h.map(b=>[b.element.name,Le(b)])),y=new Map;for(let b=0;b<t.columns.length;b++){const A=t.columns[b].meta_data;if(!A)throw new Error("parquet column metadata is undefined");const I=A.path_in_schema[0];if(s&&!s.includes(I))continue;const[v,E]=ae(A).map(Number),R=E-v;if(R>1<<30){console.warn(`parquet skipping huge column "${A.path_in_schema}" ${R.toLocaleString()} bytes`);continue}let D,H=0;w?(D=Promise.resolve(w),H=v-_):D=Promise.resolve(i.slice(v,E)),p.push(D.then(xe=>{const q=re(r.schema,A.path_in_schema),Me={view:new DataView(xe),offset:H},Ue={columnName:A.path_in_schema.join("."),type:A.type,element:q[q.length-1].element,schemaPath:q,codec:A.codec,compressors:e.compressors,utf8:e.utf8};let x=vt(Me,c,Ue,e.onPage);if(!e.onComplete&&!e.onChunk)return;const Ce=A.path_in_schema.join(".");y.set(Ce,x),x=void 0;const M=m.get(I);if(M!=null&&M.every(N=>y.has(N))){const N=new Map(M.map(k=>[k,le(y.get(k))]));U(N,q[1]);const ee=N.get(I);if(!ee)throw new Error(`parquet column data not assembled: ${I}`);x=[ee],M.forEach(k=>y.delete(k)),y.set(I,x)}if(x&&e.onChunk)for(const N of x)e.onChunk({columnName:I,columnData:N,rowStart:n,rowEnd:n+N.length})}))}if(await Promise.all(p),e.onComplete){const b=h.map(E=>E.element.name).filter(E=>!s||s.includes(E)),A=s||b,I=A.map(E=>b.includes(E)?le(y.get(E)):void 0),v=new Array(u);for(let E=l;E<u;E++)if(e.rowFormat==="object"){const R={};for(let D=0;D<A.length;D++)R[A[D]]=(g=I[D])==null?void 0:g[E];v[E]=R}else v[E]=I.map(R=>R==null?void 0:R[E]);return v}return[]}function le(e){if(!e)return[];if(e.length===1)return e[0];const t=[];for(const n of e)Te(t,n);return t}function Le(e,t=[]){if(e.children.length)for(const n of e.children)Le(n,t);else t.push(e.path.join("."));return t}function Lt(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.format==="parquet_b64"&&typeof e.data=="string"}const C=new Map,Nt=8;function ue(e,t){if(C.size>=Nt){const n=C.keys().next().value;n!==void 0&&C.delete(n)}C.set(e,t)}function Ot(e){const t=atob(e),n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n.buffer}function Pt(e){const t={};for(const[n,i]of Object.entries(e))if(n==="index"||n==="level_0")t[n]=i;else if(typeof i=="string")try{t[n]=JSON.parse(i)}catch{t[n]=i}else t[n]=i;return t}function Ne(e){if(e==null)return[];if(Array.isArray(e))return e;if(Lt(e)){const t=C.get(e.data);if(t&&t.length>0)return t;try{const n=Ot(e.data),i=K(n);let r=[];return Dt({file:n,metadata:i,rowFormat:"object",onComplete:s=>{r=s.map(Pt),ue(e.data,r)}}),r.length>0&&ue(e.data,r),r}catch(n){return console.error("resolveDFData: failed to decode parquet_b64",n),[]}}return console.warn("resolveDFData: unknown payload format",e),[]}const Bt=(e,t,n,i)=>{if(e==="main")return{data_type:"DataSource",datasource:n,length:i||50};{const r=Ne(t[e]);return{data_type:"Raw",data:r,length:r.length}}};function Oe({df_data_dict:e,df_display_args:t,df_meta:n,operations:i,on_operations:r,operation_results:s,command_config:f,buckaroo_state:o,on_buckaroo_state:a,buckaroo_options:l,src:u}){console.log("132 BuckarooInfiniteWidget");const c=new Date,_=P.useMemo(()=>(console.log("recreating data source because operations changed",c,new Date-c),u.debugCacheState(),Ye(u)),[i,o.post_processing,o.cleaning_method,JSON.stringify(o.quick_command_args)]),[d,w]=P.useState(["a","stoptime"]),p=t[o.df_display],[h,m]=P.useMemo(()=>[Bt(p.data_key,e,_,n.total_rows),Ne(e[p.summary_stats_key])],[p,i,o]),y=[i,o.post_processing,o.quick_command_args,o.df_display];return T.jsxs("div",{className:"dcf-root flex flex-col buckaroo-widget buckaroo-infinite-widget",style:{width:"100%",height:"100%"},children:[T.jsxs("div",{className:"orig-df flex flex-row",style:{overflow:"hidden"},children:[T.jsx(Fe,{dfMeta:n,buckarooState:o,setBuckarooState:a,buckarooOptions:l}),T.jsx(je,{data_wrapper:h,df_viewer_config:p.df_viewer_config,summary_stats_data:m,outside_df_params:y,activeCol:d,setActiveCol:w,error_info:""})]}),o.show_commands?T.jsx(qe,{df_viewer_config:p.df_viewer_config,activeColumn:d,operations:i,setOperations:r,operation_result:s,command_config:f}):T.jsx("span",{})]})}Oe.__docgenInfo={description:"",methods:[],displayName:"BuckarooInfiniteWidget",props:{df_meta:{required:!0,tsType:{name:"DFMeta"},description:""},df_data_dict:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"union",raw:"DFData | ParquetB64Payload",elements:[{name:"Array",elements:[{name:"Record",elements:[{name:"string"},{name:"union",raw:"string | number | boolean | any[] | Record<string, any> | null",elements:[{name:"string"},{name:"number"},{name:"boolean"},{name:"Array",elements:[{name:"any"}],raw:"any[]"},{name:"Record",elements:[{name:"string"},{name:"any"}],raw:"Record<string, any>"},{name:"null"}]}],raw:`Record<
    string,
    string | number | boolean | any[] | Record<string, any> | null
>`}],raw:"DFDataRow[]"},{name:"ParquetB64Payload"}]}],raw:"Record<string, DFDataOrPayload>"},description:""},df_display_args:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"IDisplayArgs"}],raw:"Record<string, IDisplayArgs>"},description:""},operations:{required:!0,tsType:{name:"Array",elements:[{name:"union",raw:"OperationSingleColumn | OperationSingleArg | OperationTwoArg",elements:[{name:"tuple",raw:"[SymbolT, SymbolDf, string]",elements:[{name:"SymbolT"},{name:"SymbolDf"},{name:"string"}]},{name:"tuple",raw:"[SymbolT, SymbolDf, string, Atom]",elements:[{name:"SymbolT"},{name:"SymbolDf"},{name:"string"},{name:"union",raw:"number | string | SymbolT | ColEnumArgs",elements:[{name:"number"},{name:"string"},{name:"SymbolT"},{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>"}]}]},{name:"tuple",raw:"[SymbolT, SymbolDf, string, Atom, Atom]",elements:[{name:"SymbolT"},{name:"SymbolDf"},{name:"string"},{name:"union",raw:"number | string | SymbolT | ColEnumArgs",elements:[{name:"number"},{name:"string"},{name:"SymbolT"},{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>"}]},{name:"union",raw:"number | string | SymbolT | ColEnumArgs",elements:[{name:"number"},{name:"string"},{name:"SymbolT"},{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>"}]}]}]}],raw:"Operation[]"},description:""},on_operations:{required:!0,tsType:{name:"signature",type:"function",raw:"(ops: Operation[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"union",raw:"OperationSingleColumn | OperationSingleArg | OperationTwoArg",elements:[{name:"tuple",raw:"[SymbolT, SymbolDf, string]",elements:[{name:"SymbolT"},{name:"SymbolDf"},{name:"string"}]},{name:"tuple",raw:"[SymbolT, SymbolDf, string, Atom]",elements:[{name:"SymbolT"},{name:"SymbolDf"},{name:"string"},{name:"union",raw:"number | string | SymbolT | ColEnumArgs",elements:[{name:"number"},{name:"string"},{name:"SymbolT"},{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>"}]}]},{name:"tuple",raw:"[SymbolT, SymbolDf, string, Atom, Atom]",elements:[{name:"SymbolT"},{name:"SymbolDf"},{name:"string"},{name:"union",raw:"number | string | SymbolT | ColEnumArgs",elements:[{name:"number"},{name:"string"},{name:"SymbolT"},{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>"}]},{name:"union",raw:"number | string | SymbolT | ColEnumArgs",elements:[{name:"number"},{name:"string"},{name:"SymbolT"},{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>"}]}]}]}],raw:"Operation[]"},name:"ops"}],return:{name:"void"}}},description:""},operation_results:{required:!0,tsType:{name:"signature",type:"object",raw:`{
    transformed_df: DFWhole;
    generated_py_code: string;
    transform_error?: string;
}`,signature:{properties:[{key:"transformed_df",value:{name:"DFWhole",required:!0}},{key:"generated_py_code",value:{name:"string",required:!0}},{key:"transform_error",value:{name:"string",required:!1}}]}},description:""},command_config:{required:!0,tsType:{name:"signature",type:"object",raw:`{
    argspecs: CommandArgSpec;
    defaultArgs: OperationDefaultArgs;
}`,signature:{properties:[{key:"argspecs",value:{name:"Record",elements:[{name:"string"},{name:"Array",elements:[{name:"union",raw:"TypeSpec | EnumSpec | ColEnumSpec | NoArgs",elements:[{name:"tuple",raw:'[number, string, "type", "integer" | "float" | "string"]',elements:[{name:"number"},{name:"string"},{name:"literal",value:'"type"'},{name:"union",raw:'"integer" | "float" | "string"',elements:[{name:"literal",value:'"integer"'},{name:"literal",value:'"float"'},{name:"literal",value:'"string"'}]}]},{name:"tuple",raw:'[number, string, "enum", string[]]',elements:[{name:"number"},{name:"string"},{name:"literal",value:'"enum"'},{name:"Array",elements:[{name:"string"}],raw:"string[]"}]},{name:"tuple",raw:'[number, string, "colEnum", string[]]',elements:[{name:"number"},{name:"string"},{name:"literal",value:'"colEnum"'},{name:"Array",elements:[{name:"string"}],raw:"string[]"}]},{name:"null"}]}],raw:"ArgSpec[]"}],raw:"Record<string, ArgSpec[]>",required:!0}},{key:"defaultArgs",value:{name:"Record",elements:[{name:"string"},{name:"union",raw:"OperationSingleColumn | OperationSingleArg | OperationTwoArg",elements:[{name:"tuple",raw:"[SymbolT, SymbolDf, string]",elements:[{name:"SymbolT"},{name:"SymbolDf"},{name:"string"}]},{name:"tuple",raw:"[SymbolT, SymbolDf, string, Atom]",elements:[{name:"SymbolT"},{name:"SymbolDf"},{name:"string"},{name:"union",raw:"number | string | SymbolT | ColEnumArgs",elements:[{name:"number"},{name:"string"},{name:"SymbolT"},{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>"}]}]},{name:"tuple",raw:"[SymbolT, SymbolDf, string, Atom, Atom]",elements:[{name:"SymbolT"},{name:"SymbolDf"},{name:"string"},{name:"union",raw:"number | string | SymbolT | ColEnumArgs",elements:[{name:"number"},{name:"string"},{name:"SymbolT"},{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>"}]},{name:"union",raw:"number | string | SymbolT | ColEnumArgs",elements:[{name:"number"},{name:"string"},{name:"SymbolT"},{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>"}]}]}]}],raw:"Record<string, Operation>",required:!0}}]}},description:""},buckaroo_state:{required:!0,tsType:{name:"BuckarooState"},description:""},on_buckaroo_state:{required:!0,tsType:{name:"ReactDispatch",raw:"React.Dispatch<React.SetStateAction<BuckarooState>>",elements:[{name:"ReactSetStateAction",raw:"React.SetStateAction<BuckarooState>",elements:[{name:"BuckarooState"}]}]},description:""},buckaroo_options:{required:!0,tsType:{name:"BuckarooOptions"},description:""},src:{required:!0,tsType:{name:"KeyAwareSmartRowCache"},description:""}}};const xt=["Alice","Bob","Charlie","Diana","Eve"],Z=5,ce=xt.map((e,t)=>({index:t,name:e,age:25+t*3,score:80+t*3.5})),Pe=[{index:"dtype",name:"object",age:"int64",score:"float64"},{index:"count",name:5,age:5,score:5},{index:"unique",name:5,age:5,score:5},{index:"mean",name:"N/A",age:34,score:90.5},{index:"min",name:"Alice",age:25,score:80},{index:"max",name:"Eve",age:37,score:94}],Mt=Pe.map(e=>({primary_key_val:e.index,displayer_args:{displayer:"obj"}})),Be={column_config:[{col_name:"name",header_name:"name",displayer_args:{displayer:"obj"}},{col_name:"age",header_name:"age",displayer_args:{displayer:"integer",min_digits:1,max_digits:5}},{col_name:"score",header_name:"score",displayer_args:{displayer:"float",min_fraction_digits:1,max_fraction_digits:2}}],pinned_rows:[],left_col_configs:[{col_name:"index",header_name:"index",displayer_args:{displayer:"string"}}]},Ut={...Be,pinned_rows:Mt},Ct={main:{data_key:"main",df_viewer_config:Be,summary_stats_key:"all_stats"},summary:{data_key:"main",df_viewer_config:Ut,summary_stats_key:"all_stats"}},qt={total_rows:Z,columns:3,filtered_rows:Z,rows_shown:Z},kt={sampled:[],cleaning_method:[],post_processing:[],df_display:["main","summary"],show_commands:[]},Ft={argspecs:{},defaultArgs:{}},Yt=()=>{const[e,t]=P.useState({sampled:!1,cleaning_method:!1,quick_command_args:{},post_processing:!1,df_display:"main",show_commands:!1}),[n,i]=P.useState([]),r=P.useMemo(()=>{const f=new $e(o=>{let a=ce;try{const c=JSON.parse(o.sourceName||"[]"),_=c[2]||c[1];if(_&&typeof _=="object"&&_.search&&_.search[0]){const d=String(_.search[0]).toLowerCase();a=ce.filter(w=>String(w.name).toLowerCase().includes(d))}}catch{}const l=Math.min(o.end,a.length);if(l<=o.start){const c={key:o,data:[],length:a.length};setTimeout(()=>f.addPayloadResponse(c),10);return}const u={key:o,data:a.slice(o.start,l),length:a.length};setTimeout(()=>f.addPayloadResponse(u),10)});return f},[]),s=P.useMemo(()=>({main:[],all_stats:Pe,empty:[]}),[]);return T.jsx("div",{style:{height:600,width:900},children:T.jsx(Oe,{df_meta:qt,df_data_dict:s,df_display_args:Ct,operations:n,on_operations:i,operation_results:ke,command_config:Ft,buckaroo_state:e,on_buckaroo_state:t,buckaroo_options:kt,src:r})})},rn={title:"Buckaroo/BuckarooWidgetTest",component:Yt,parameters:{layout:"centered"}},Y={};var me,de,_e;Y.parameters={...Y.parameters,docs:{...(me=Y.parameters)==null?void 0:me.docs,source:{originalSource:"{}",...(_e=(de=Y.parameters)==null?void 0:de.docs)==null?void 0:_e.source}}};const sn=["Primary"];export{Y as Primary,sn as __namedExportsOrder,rn as default};
