diff --git a/packages/buckaroo-js-core/src/components/DFViewerParts/SmartRowCache.ts b/packages/buckaroo-js-core/src/components/DFViewerParts/SmartRowCache.ts
index fa0d3c6..67b354f 100644
--- a/packages/buckaroo-js-core/src/components/DFViewerParts/SmartRowCache.ts
+++ b/packages/buckaroo-js-core/src/components/DFViewerParts/SmartRowCache.ts
@@ -443,16 +443,16 @@ export class SmartRowCache {
         try {
             console.log("[SmartRowCache.getRows] range", range, "extents", this.safeGetExtents(), "segments", this.segments);
         } catch (_e) {}
+        if (this.sentLength > 0 && range[1] > this.sentLength) {
+            return this.getRows([range[0], this.sentLength]);
+        }
         if (this.hasRows(range) === true) {
             if(range[0] === 0 && range[1] === 0) {
                 console.log("unexpected setting lastRequest to [0,0] in getRows")
             }
             this.lastRequest = range;
             return getRange(this.segments, this.dfs, range)
-        } else if (range[0] === 0 && range[1] > this.sentLength && this.sentLength !== 0) {
-	    const fullSeg: Segment = [0, this.sentLength];
-	    return getRange(this.segments, this.dfs, fullSeg)
-	}
+        }
         console.error("[SmartRowCache.getRows] Missing rows error. range", range, "extents", this.safeGetExtents(), "segments", this.segments, "sentLength", this.sentLength);
         throw new Error(`Missing rows for {range}`)
     }
@@ -542,8 +542,8 @@ export class KeyAwareSmartRowCache {
 	this.srcAccesses.set(srcKey, src);
 
 	if (src.sentLength !== 0 &&  src.sentLength < pa.end) {
-	    const newSeg:Segment = [pa.start, src.sentLength];
-	    //console.log("at failing point", newSeg, src.getExtents())
+	    const clampedEnd = Math.min(pa.origEnd, src.sentLength);
+	    const newSeg:Segment = [pa.start, clampedEnd];
 	    return src.getRows(newSeg);
 	}
         return src.getRows(seg);
@@ -633,15 +633,13 @@ export class KeyAwareSmartRowCache {
         const cbKey = getPayloadKey(resp.key)
         //const preExtents = src.safeGetExtents()
 
-	if(resp.length < resp.key.end && resp.key.start === 0) {
-	    // add tests
-	    const entireSeg: Segment = [0, resp.length];
-            src.addRows(entireSeg, resp.data)
+        src.sentLength = resp.length;
+	if(resp.data.length < (seg[1] - seg[0])) {
+	    const actualSeg: Segment = [resp.key.start, resp.key.start + resp.data.length];
+            src.addRows(actualSeg, resp.data)
 	} else {
             src.addRows(seg, resp.data)
 	}
-        //console.log(`response before ${[resp.key.start, resp.key.origEnd, resp.key.end]} before add, preExtents ${preExtents}, post extents ${src.safeGetExtents()}`)
-        src.sentLength = resp.length;
         if (_.has(this.waitingCallbacks, cbKey)) {
             const [success, fail] = this.waitingCallbacks[cbKey];
             if(verifyResp(resp)) {
